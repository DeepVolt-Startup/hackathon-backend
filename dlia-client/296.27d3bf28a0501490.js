"use strict";(self.webpackChunkDLIA_client=self.webpackChunkDLIA_client||[]).push([[296],{296:(L,b,p)=>{p.d(b,{z:()=>D});var v=p(1135),h=p(6895),m=p(7155),f=p(266),C=p(6308),d=p(7392),n=p(6115),T=p(8754),t=p(4650),u=p(5938);function x(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"mat-icon",25),t.NdJ("click",function(){t.CHM(o);const l=t.oxw();return t.KtG(l.saveComparison())}),t._uU(1,"bookmark_add"),t.qZA()}2&e&&t.Q6J("ngClass","hover:cursor-pointer")}function r(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"mat-icon",26),t.NdJ("click",function(){t.CHM(o);const l=t.oxw();return t.KtG(l.deleteComparison())}),t._uU(1,"delete"),t.qZA()}2&e&&t.Q6J("ngClass","hover:cursor-pointer")}function s(e,c){1&e&&(t.TgZ(0,"th",27),t._uU(1," Name "),t.qZA())}function _(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",o.name," ")}}function g(e,c){1&e&&(t.TgZ(0,"th",29),t._uU(1," Poi Type "),t.qZA())}function y(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",o.type," ")}}function Z(e,c){1&e&&(t.TgZ(0,"th",29),t._uU(1," Score "),t.qZA())}function S(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.score,"1.2-2")," ")}}function U(e,c){1&e&&(t.TgZ(0,"th",30),t._uU(1," Population density... "),t.qZA())}function w(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.populationDensity,"1.0-0")," ")}}function A(e,c){1&e&&(t.TgZ(0,"th",31),t._uU(1," Median revenue... "),t.qZA())}function k(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.medianRevenue,"1.0-0")," ")}}function I(e,c){1&e&&(t.TgZ(0,"th",32),t._uU(1," Nearby POIs count... "),t.qZA())}function N(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",o.poiNearbyCount," ")}}function R(e,c){1&e&&(t.TgZ(0,"th",33),t._uU(1," Competition count... "),t.qZA())}function P(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",o.competitionCount," ")}}function E(e,c){1&e&&(t.TgZ(0,"th",29),t._uU(1," EV Registrations in commune "),t.qZA())}function Y(e,c){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"number"),t.qZA()),2&e){const o=c.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.evRegistration,"1.0-0")," ")}}function O(e,c){1&e&&(t.TgZ(0,"th",34),t._uU(1," Actions "),t.qZA())}function M(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"td",28)(1,"mat-icon",35),t.NdJ("click",function(){const a=t.CHM(o).$implicit,W=t.oxw();return t.KtG(W.deleteLocation(a))}),t._uU(2,"delete"),t.qZA()()}2&e&&(t.xp6(1),t.Q6J("ngClass","hover:cursor-pointer"))}function B(e,c){1&e&&t._UZ(0,"tr",36)}function Q(e,c){1&e&&t._UZ(0,"tr",37)}let J=(()=>{class e{constructor(o,i,l){this.dialogRef=o,this._compareService=i,this.dialog=l,this.displayedColumns=["name","type","score","populationDensity","medianRevenue","poiNearbyCount","competitionCount","evRegistration","actions"],this.isSaved=!1,this.comparisonId="",this._compareService.compareLocationsList$.subscribe({next:a=>{this.compareLocationDataSource=new m.by(a)}}),this._compareService.isComparisonSaved$.subscribe({next:a=>{this.isSaved=a.isSaved,this.comparisonId=a.id}})}ngAfterViewInit(){this.compareLocationDataSource.sort=this.sort}onCancel(){this.dialogRef.close(!1)}saveComparison(){this.dialog.open(n.a,{width:"30%",minWidth:"300px"}).afterClosed().subscribe(i=>{i&&this._compareService.savedComparison(i.name,i.description)})}deleteComparison(){this.dialog.open(T.$,{width:"30%",minWidth:"300px",data:{content:"Are you sure you want to remove this comparison?"}}).afterClosed().subscribe(i=>{i&&this._compareService.deleteComparison(this.comparisonId)})}deleteLocation(o){this.dialog.open(T.$,{width:"30%",minWidth:"300px",data:{content:"Are you sure you want to remove this location?"}}).afterClosed().subscribe(l=>{l&&(console.log("this is the index : ",o.index),this._compareService.removeLocation(o.index))})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(u.so),t.Y36(D),t.Y36(u.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-comparison-table"]],viewQuery:function(o,i){if(1&o&&t.Gf(C.YE,5),2&o){let l;t.iGM(l=t.CRH())&&(i.sort=l.first)}},standalone:!0,features:[t.jDz],decls:37,vars:5,consts:[[1,"w-full","flex","items-center","justify-end","mb-3"],["style","font-size: 30px; width: 30px; height: 30px; margin-right: 10px","class","bookmark-icon-color",3,"ngClass","click",4,"ngIf"],["style","\n        font-size: 30px;\n        width: 30px;\n        height: 30px;\n        margin-right: 10px;\n        color: red;\n      ","class","bookmark-icon-color",3,"ngClass","click",4,"ngIf"],[1,"text-gray-500","hover:text-red-500","cursor-pointer","mr-1",3,"click"],[1,"shadow","overflow-hidden","border-b","border-gray-200","sm:rounded-lg"],["mat-table","","matSort","",1,"min-w-full","divide-y","divide-gray-200",3,"dataSource"],["matColumnDef","name"],["mat-sort-header","","mat-header-cell","","class","px-6 py-3 text-left text-xs font-medium text-gray-500",4,"matHeaderCellDef"],["mat-cell","","class","px-6 py-4 whitespace-nowrap",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","","mat-sort-header","","class","px-6 py-3 text-left text-xs font-medium text-gray-500",4,"matHeaderCellDef"],["matColumnDef","score"],["matColumnDef","populationDensity"],["mat-header-cell","","mat-sort-header","","class","px-6 py-3 text-left text-xs font-medium text-gray-500","matTooltip","Population density (Habitant/Km\xb2)",4,"matHeaderCellDef"],["matColumnDef","medianRevenue"],["mat-header-cell","","mat-sort-header","","class","px-6 py-3 text-left text-xs font-medium text-gray-500","matTooltip","Median revenue (\u20ac/Capita)",4,"matHeaderCellDef"],["matColumnDef","poiNearbyCount"],["mat-header-cell","","mat-sort-header","","class","px-6 py-3 text-left text-xs font-medium text-gray-500","matTooltip","Nearby POIs count (within 300m)",4,"matHeaderCellDef"],["matColumnDef","competitionCount"],["mat-header-cell","","mat-sort-header","","class","px-6 py-3 text-left text-xs font-medium text-gray-500","matTooltip","Competition count (within 500m)",4,"matHeaderCellDef"],["matColumnDef","evRegistration"],["matColumnDef","actions"],["mat-header-cell","","class","px-6 py-3 text-left text-xs font-medium text-gray-500",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-100",4,"matRowDef","matRowDefColumns"],[1,"bookmark-icon-color",2,"font-size","30px","width","30px","height","30px","margin-right","10px",3,"ngClass","click"],[1,"bookmark-icon-color",2,"font-size","30px","width","30px","height","30px","margin-right","10px","color","red",3,"ngClass","click"],["mat-sort-header","","mat-header-cell","",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],["mat-cell","",1,"px-6","py-4","whitespace-nowrap"],["mat-header-cell","","mat-sort-header","",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],["mat-header-cell","","mat-sort-header","","matTooltip","Population density (Habitant/Km\xb2)",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],["mat-header-cell","","mat-sort-header","","matTooltip","Median revenue (\u20ac/Capita)",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],["mat-header-cell","","mat-sort-header","","matTooltip","Nearby POIs count (within 300m)",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],["mat-header-cell","","mat-sort-header","","matTooltip","Competition count (within 500m)",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],["mat-header-cell","",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500"],[2,"font-size","30px","width","30px","height","30px","margin-right","10px","color","red",3,"ngClass","click"],["mat-header-row",""],["mat-row","",1,"hover:bg-gray-100"]],template:function(o,i){1&o&&(t.TgZ(0,"div")(1,"div",0),t.YNc(2,x,2,1,"mat-icon",1),t.YNc(3,r,2,1,"mat-icon",2),t.TgZ(4,"mat-icon",3),t.NdJ("click",function(){return i.onCancel()}),t._uU(5,"close"),t.qZA()(),t.TgZ(6,"div",4)(7,"table",5),t.ynx(8,6),t.YNc(9,s,2,0,"th",7),t.YNc(10,_,2,1,"td",8),t.BQk(),t.ynx(11,9),t.YNc(12,g,2,0,"th",10),t.YNc(13,y,2,1,"td",8),t.BQk(),t.ynx(14,11),t.YNc(15,Z,2,0,"th",10),t.YNc(16,S,3,4,"td",8),t.BQk(),t.ynx(17,12),t.YNc(18,U,2,0,"th",13),t.YNc(19,w,3,4,"td",8),t.BQk(),t.ynx(20,14),t.YNc(21,A,2,0,"th",15),t.YNc(22,k,3,4,"td",8),t.BQk(),t.ynx(23,16),t.YNc(24,I,2,0,"th",17),t.YNc(25,N,2,1,"td",8),t.BQk(),t.ynx(26,18),t.YNc(27,R,2,0,"th",19),t.YNc(28,P,2,1,"td",8),t.BQk(),t.ynx(29,20),t.YNc(30,E,2,0,"th",10),t.YNc(31,Y,3,4,"td",8),t.BQk(),t.ynx(32,21),t.YNc(33,O,2,0,"th",22),t.YNc(34,M,3,1,"td",8),t.BQk(),t.YNc(35,B,1,0,"tr",23),t.YNc(36,Q,1,0,"tr",24),t.qZA()()()),2&o&&(t.xp6(2),t.Q6J("ngIf",!i.isSaved),t.xp6(1),t.Q6J("ngIf",i.isSaved),t.xp6(4),t.Q6J("dataSource",i.compareLocationDataSource),t.xp6(28),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},dependencies:[h.ez,h.mk,h.O5,h.JJ,m.p0,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,f.AV,f.gM,C.JX,C.YE,C.nU,d.Ps,d.Hw],styles:["[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:50px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{border-radius:6px;background:#f1f1f1}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:6px;background:#888;height:20%}[_ngcontent-%COMP%]::-webkit-scrollbar-button{height:100%}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{-webkit-transition:.8s;transition:.8s;background:#555}  .mat-sort-header-container{border-bottom:none!important}.bookmark-icon-color[_ngcontent-%COMP%]{color:#666;transition:color .5s}  .custom-style-green{background-color:#10b981;color:#fff}  .custom-style-red{background-color:#fe5157;color:#fff}  .mat-simple-snackbar-action>button{color:#fff}"]}),e})();var H=p(2340),j=p(1588),z=p(529),$=p(7009),F=p(6616);let D=(()=>{class e{constructor(o,i,l,a){this.dialog=o,this._httpClient=i,this.snackBar=l,this._tokenService=a,this.uri=H.N.apiUrl,this.compareLocationsList=new v.X([]),this.isComparisonSaved=new v.X({isSaved:!1,id:""})}get compareLocationsList$(){return this.compareLocationsList}set _compareLocationsList(o){this.compareLocationsList.next(o)}get isComparisonSaved$(){return this.isComparisonSaved}set _isComparisonSaved(o){this.isComparisonSaved.next(o)}addLocationWithScore(o){let i=[...this.compareLocationsList.value,o];i.sort((l,a)=>a.score-l.score),this._compareLocationsList=i,this._isComparisonSaved={isSaved:!1,id:""}}addLocations(o,i){i&&o.forEach(l=>{this.addLocationWithScore(l)})}removeLocation(o){let i=this.compareLocationsList.value;const l=i.findIndex(a=>a.index===o);-1!==l&&(console.error("hello "),i.splice(l,1)),this._compareLocationsList=i,this._isComparisonSaved={isSaved:!1,id:""}}openDetailedComparisonDialog(){console.log(this.compareLocationsList.value),this.dialog.open(J,{maxWidth:"100vw",maxHeight:"100vh",width:"100%",height:"100%"})}openDetailedComparisonDialogFromLocations(o){this._compareLocationsList=[],this.addLocations(o,!0),console.log(this.compareLocationsList.value),this.openDetailedComparisonDialog()}savedComparison(o,i){let l={locations:[],comparison:{comparison_name:o,note:i}};this.compareLocationsList.value.forEach(a=>{console.log(a),l.locations.push({name:a.name,saved_name:a.name,type_location:a.type,long:a.lon,lat:a.lat,note:"",location_source:"compared_location",site_attractiveness_score:a.score,population_densit:a.populationDensity,median_revenue:a.medianRevenue,nearby_POIs_count:a.poiNearbyCount,competition_count:a.competitionCount,ev_registration:a.evRegistration,location_address:"",ev_connectors:"[]",user_id:this._tokenService.getuserId()})}),console.log(l),this._httpClient.post(this.uri+"/v1/user/locations/save-comparison",l).subscribe({next:a=>{this._isComparisonSaved={isSaved:!0,id:a.savedComparison.comparison_id},this.snackBar.open("Comparison saved successfully","colse",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]})},error:a=>{this.snackBar.open("An error has occurred. Please try again later.","colse",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style"]})}})}deleteComparison(o){this._httpClient.delete(this.uri+"/v1/user/comparisons",{body:{comparisons:[o]}}).subscribe({next:i=>{this.snackBar.open(i.msg,"colse",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]}),this._isComparisonSaved={isSaved:!1,id:""}},error:i=>{this.snackBar.open("An error has occurred. Please try again later.","colse",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-red"]})}})}openDetailedComparisonDialogFromId(o){this._compareLocationsList=[],this._httpClient.get(this.uri+`/v1/user/comparisons/${o}`).subscribe({next:i=>{let l=[];i.forEach(a=>{l.push({index:(0,j.Z)(),name:a.name,type:a.type_location,score:a.site_attractiveness_score,populationDensity:a.population_densit,medianRevenue:a.median_revenue,poiNearbyCount:a.nearby_POIs_count,competitionCount:a.competition_count,evRegistration:a.ev_registrations}),console.log(a)}),this.addLocations(l,!0),this.openDetailedComparisonDialog()}})}clearData(){this._compareLocationsList=[],this._isComparisonSaved={isSaved:!1,id:""}}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(u.uw),t.LFG(z.eN),t.LFG($.ux),t.LFG(F.B))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},6115:(L,b,p)=>{p.d(b,{a:()=>t});var v=p(6895),h=p(5938),m=p(4006),f=p(9549),C=p(4144),d=p(4859),n=p(4650);function T(u,x){1&u&&(n.TgZ(0,"mat-error"),n._uU(1,"Name is required"),n.qZA())}let t=(()=>{class u{constructor(r,s){this.dialogRef=r,this.data=s}ngOnInit(){this.savelocation=new m.cw({name:new m.NI("",m.kI.required),description:new m.NI("")})}onCancel(){this.dialogRef.close()}submitSaveLocationForm(){this.dialogRef.close(this.savelocation.getRawValue())}}return u.\u0275fac=function(r){return new(r||u)(n.Y36(h.so),n.Y36(h.WI))},u.\u0275cmp=n.Xpm({type:u,selectors:[["app-location-save-input"]],standalone:!0,features:[n.jDz],decls:17,vars:6,consts:[[1,"text-3xl","font-medium",2,"color","#335579"],[1,"flex","flex-col","mt-3",3,"formGroup","submit"],["appearance","outline"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["matInput","","formControlName","description"],[1,"flex","justify-end","space-x-2"],["mat-button","","type","button",1,"bg-gray-300","text-gray-800","py-2","px-4","rounded",3,"click"],["mat-raised-button","","color","primary","type","submit","mat-raised-button","",1,"text-white","py-2","px-4","rounded",2,"background","#335579","color","#fff",3,"disabled"]],template:function(r,s){1&r&&(n.TgZ(0,"span",0),n._uU(1,"Save comparison"),n.qZA(),n.TgZ(2,"form",1),n.NdJ("submit",function(){return s.submitSaveLocationForm()}),n.TgZ(3,"mat-form-field",2)(4,"mat-label"),n._uU(5,"Name"),n.qZA(),n._UZ(6,"input",3),n.YNc(7,T,2,0,"mat-error",4),n.qZA(),n.TgZ(8,"mat-form-field",2)(9,"mat-label"),n._uU(10,"Description"),n.qZA(),n._UZ(11,"textarea",5),n.qZA(),n.TgZ(12,"div",6)(13,"button",7),n.NdJ("click",function(){return s.onCancel()}),n._uU(14," Cancel "),n.qZA(),n.TgZ(15,"button",8),n._uU(16," Save "),n.qZA()()()),2&r&&(n.xp6(2),n.Q6J("formGroup",s.savelocation),n.xp6(5),n.Q6J("ngIf",null==s.savelocation.get("name").errors?null:s.savelocation.get("name").errors.required),n.xp6(8),n.Akn(s.savelocation.valid?"background-color:#335579;color:white;":"background-color:rgba(224,224,224,1);"),n.Q6J("disabled",s.savelocation.invalid)("disabled",!s.savelocation.valid))},dependencies:[v.ez,v.O5,m.u5,m._Y,m.Fj,m.JJ,m.JL,m.Q7,m.UX,m.sg,m.u,C.c,f.TO,f.KE,f.hX,C.Nt,d.ot,d.lW,f.lN],encapsulation:2}),u})()},1588:(L,b,p)=>{p.d(b,{Z:()=>x});const h={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let m;const f=new Uint8Array(16);function C(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(f)}const d=[];for(let r=0;r<256;++r)d.push((r+256).toString(16).slice(1));const x=function u(r,s,_){if(h.randomUUID&&!s&&!r)return h.randomUUID();const g=(r=r||{}).random||(r.rng||C)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,s){_=_||0;for(let y=0;y<16;++y)s[_+y]=g[y];return s}return function n(r,s=0){return(d[r[s+0]]+d[r[s+1]]+d[r[s+2]]+d[r[s+3]]+"-"+d[r[s+4]]+d[r[s+5]]+"-"+d[r[s+6]]+d[r[s+7]]+"-"+d[r[s+8]]+d[r[s+9]]+"-"+d[r[s+10]]+d[r[s+11]]+d[r[s+12]]+d[r[s+13]]+d[r[s+14]]+d[r[s+15]]).toLowerCase()}(g)}}}]);