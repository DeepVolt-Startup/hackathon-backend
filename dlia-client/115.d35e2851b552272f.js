"use strict";(self.webpackChunkDLIA_client=self.webpackChunkDLIA_client||[]).push([[115],{7115:(G,_,a)=>{a.r(_),a.d(_,{ProfileComponent:()=>j});var m=a(6895),d=a(7392),Z=a(782),p=a(4144),f=a(4859),l=a(9549),w=a(8563),n=a(4006),C=a(2510),P=a(5938),c=a(7009),g=a(1572),o=a(4650),y=a(8386);function v(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Minimum length is 8"),o.qZA())}function N(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Old password is required"),o.qZA())}function T(t,i){1&t&&(o.TgZ(0,"mat-icon"),o._UZ(1,"mat-spinner",15),o.qZA())}function b(t,i){1&t&&(o.TgZ(0,"span"),o._uU(1,"Update"),o.qZA())}function F(t,i){return r=>{const e=r.get(t),s=r.get(i);return e.value!==s.value?{passwordMismatchError:!0}:null}}let U=(()=>{class t{constructor(r,e,s){this.dialog=r,this._userService=e,this.snackBar=s,this.hidePassword=!0,this.hideNewPassword=!0,this.confirmNewPassword=!0,this.hideConfirmPassword=!0,this.updatePasswordLoading=!1,this.confirmErrorMatcher={isErrorState:(u,H)=>{const K=u.touched&&u.invalid,X=u.touched&&this.updatePasswordForm.get("confirmNewPassword").touched&&this.updatePasswordForm.errors?.passwordMismatchError;return K||X}}}ngOnInit(){this.updatePasswordForm=new n.cw({oldPassword:new n.NI("",[n.kI.required,n.kI.minLength(8)]),newPassword:new n.NI("",[n.kI.required,n.kI.minLength(8)]),confirmNewPassword:new n.NI("",[n.kI.required,n.kI.minLength(8)])},{validators:F("newPassword","confirmNewPassword")})}getPasswordErrorMessage(r){return this.updatePasswordForm.controls[r]?.hasError("required")?"Password is required":"Minimum length is 8"}onCloseDialog(){this.dialog.closeAll()}getErrorMessage(r){return this.updatePasswordForm.controls[r]?.hasError("required")?"Confirm Password is required":"Passwords do not match. Please try again"}updatePassword(){this.updatePasswordLoading=!0,this._userService.updatePsaaword({password:this.updatePasswordForm.getRawValue().oldPassword,newPassword:this.updatePasswordForm.getRawValue().newPassword}).subscribe({next:r=>{console.log(r),this.snackBar.open(r.msg,"close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]}),this.updatePasswordLoading=!1,this.onCloseDialog()},error:r=>{this.snackBar.open(r.error.msg,"close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style"]})}})}}return t.\u0275fac=function(r){return new(r||t)(o.Y36(P.uw),o.Y36(y.K),o.Y36(c.ux))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-update-password"]],standalone:!0,features:[o.jDz],decls:37,vars:17,consts:[[1,"md:","w-full"],[3,"formGroup","submit"],["type","email","name","username",1,"hidden"],[1,"flex","justify-between","items-center","mb-4","mx-0"],[1,"title"],[1,"cursor-pointer",3,"click"],[1,"grid","grid-cols-2","gap-x-5",2,"grid-template-columns","repeat(1, 1fr)"],["appearance","outline"],["matInput","","formControlName","oldPassword","placeholder","Old password",3,"type"],["matSuffix","",3,"click"],[4,"ngIf"],["matInput","","formControlName","newPassword","placeholder","New password",3,"type"],["matInput","","formControlName","confirmNewPassword","placeholder","Confirm new password",3,"type","errorStateMatcher"],[1,"container-btn","flex","justify-end"],["type","submit","mat-raised-button","",1,"update-btn","items-right",3,"disabled"],["diameter","20"]],template:function(r,e){1&r&&(o.TgZ(0,"div",0)(1,"form",1),o.NdJ("submit",function(){return e.updatePassword()}),o._UZ(2,"input",2),o.TgZ(3,"div",3)(4,"h2",4),o._uU(5,"Update password"),o.qZA(),o.TgZ(6,"mat-icon",5),o.NdJ("click",function(){return e.onCloseDialog()}),o._uU(7," clear "),o.qZA()(),o.TgZ(8,"div",6)(9,"mat-form-field",7)(10,"mat-label"),o._uU(11,"Old password"),o.qZA(),o._UZ(12,"input",8),o.TgZ(13,"mat-icon",9),o.NdJ("click",function(){return e.hidePassword=!e.hidePassword}),o._uU(14),o.qZA(),o.YNc(15,v,2,0,"mat-error",10),o.YNc(16,N,2,0,"mat-error",10),o.qZA(),o.TgZ(17,"mat-form-field",7)(18,"mat-label"),o._uU(19,"New password"),o.qZA(),o._UZ(20,"input",11),o.TgZ(21,"mat-icon",9),o.NdJ("click",function(){return e.hideNewPassword=!e.hideNewPassword}),o._uU(22),o.qZA(),o.TgZ(23,"mat-error"),o._uU(24),o.qZA()(),o.TgZ(25,"mat-form-field",7)(26,"mat-label"),o._uU(27,"Confirm new password"),o.qZA(),o._UZ(28,"input",12),o.TgZ(29,"mat-icon",9),o.NdJ("click",function(){return e.confirmNewPassword=!e.confirmNewPassword}),o._uU(30),o.qZA(),o.TgZ(31,"mat-error"),o._uU(32),o.qZA()(),o.TgZ(33,"div",13)(34,"button",14),o.YNc(35,T,2,0,"mat-icon",10),o.YNc(36,b,2,0,"span",10),o.qZA()()()()()),2&r&&(o.xp6(1),o.Q6J("formGroup",e.updatePasswordForm),o.xp6(11),o.Q6J("type",e.hidePassword?"password":"text"),o.xp6(2),o.Oqu(e.hidePassword?"visibility_off":"visibility"),o.xp6(1),o.Q6J("ngIf",e.updatePasswordForm.get("oldPassword").hasError("minlength")),o.xp6(1),o.Q6J("ngIf",null==e.updatePasswordForm.get("oldPassword").errors?null:e.updatePasswordForm.get("oldPassword").errors.required),o.xp6(4),o.Q6J("type",e.hideNewPassword?"password":"text"),o.xp6(2),o.Oqu(e.hideNewPassword?"visibility_off":"visibility"),o.xp6(2),o.Oqu(e.getPasswordErrorMessage("newPassword")),o.xp6(4),o.Q6J("type",e.confirmNewPassword?"password":"text")("errorStateMatcher",e.confirmErrorMatcher),o.xp6(2),o.Oqu(e.confirmNewPassword?"visibility_off":"visibility"),o.xp6(2),o.Oqu(e.getErrorMessage("confirmNewPassword")),o.xp6(2),o.Akn("background-color:"+(e.updatePasswordForm.valid&&!e.updatePasswordLoading?"#335579;color:white;":"#E0E0E0;color:D1D1D1;")),o.Q6J("disabled",!e.updatePasswordForm.valid||e.updatePasswordLoading),o.xp6(1),o.Q6J("ngIf",e.updatePasswordLoading),o.xp6(1),o.Q6J("ngIf",!e.updatePasswordLoading))},dependencies:[m.ez,m.O5,d.Ps,d.Hw,Z.N6,p.c,l.TO,l.KE,l.hX,l.R9,p.Nt,f.ot,f.lW,l.lN,w.g,n.u5,n._Y,n.Fj,n.JJ,n.JL,n.UX,n.sg,n.u,C.Bz,c.ZX,g.Cq,g.$g],styles:[".title[_ngcontent-%COMP%]{margin-bottom:0}.title-container[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-dialog-container[_ngcontent-%COMP%]{width:600px}  .custom-style{background-color:#fe5157;color:#fff}  .custom-style-green{background-color:#10b981;color:#fff}  .mat-simple-snackbar-action>button{color:#fff}"]}),t})();var q=a(7277),I=a(4385),h=a(7957),A=a(3238);function k(t,i){1&t&&(o.TgZ(0,"mat-icon"),o._UZ(1,"mat-spinner",7),o.qZA())}function x(t,i){1&t&&(o.TgZ(0,"span"),o._uU(1,"Save"),o.qZA())}function J(t,i){1&t&&(o.TgZ(0,"div"),o._UZ(1,"mat-spinner",8),o.qZA())}function E(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Full name is required"),o.qZA())}function L(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Full name can at least have two words"),o.qZA())}function Q(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"We only accept work email addresses"),o.qZA())}function Y(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Please enter a valid work email address."),o.qZA())}function D(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Work email is required"),o.qZA())}function M(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Company is required"),o.qZA())}function O(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Position is required"),o.qZA())}function W(t,i){if(1&t&&(o.TgZ(0,"mat-option",24),o._uU(1),o.qZA()),2&t){const r=i.$implicit;o.Q6J("value",r),o.xp6(1),o.hij(" ",r," ")}}function z(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Country is required"),o.qZA())}function V(t,i){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Please enter a valid country "),o.qZA())}function B(t,i){if(1&t){const r=o.EpF();o.TgZ(0,"form",9),o.NdJ("submit",function(){o.CHM(r);const s=o.oxw();return o.KtG(s.updateUser())}),o.TgZ(1,"div",10)(2,"mat-form-field",11)(3,"mat-label"),o._uU(4,"Full name"),o.qZA(),o._UZ(5,"input",12),o.YNc(6,E,2,0,"mat-error",5),o.YNc(7,L,2,0,"mat-error",5),o.qZA(),o.TgZ(8,"mat-form-field",11)(9,"mat-label"),o._uU(10,"Work email"),o.qZA(),o._UZ(11,"input",13),o.YNc(12,Q,2,0,"mat-error",5),o.YNc(13,Y,2,0,"mat-error",5),o.YNc(14,D,2,0,"mat-error",5),o.qZA(),o.TgZ(15,"mat-form-field",11)(16,"mat-label"),o._uU(17,"Company"),o.qZA(),o._UZ(18,"input",14),o.YNc(19,M,2,0,"mat-error",5),o.qZA(),o.TgZ(20,"mat-form-field",11)(21,"mat-label"),o._uU(22,"Position"),o.qZA(),o._UZ(23,"input",15),o.YNc(24,O,2,0,"mat-error",5),o.qZA(),o.TgZ(25,"mat-form-field",11)(26,"mat-label"),o._uU(27,"Country"),o.qZA(),o._UZ(28,"input",16),o.TgZ(29,"mat-autocomplete",null,17),o.YNc(31,W,2,2,"mat-option",18),o.qZA(),o.YNc(32,z,2,0,"mat-error",5),o.YNc(33,V,2,0,"mat-error",5),o.qZA(),o.TgZ(34,"mat-form-field",19)(35,"mat-label"),o._uU(36,"Phone number"),o.qZA(),o.TgZ(37,"input",20),o.NdJ("keydown",function(s){o.CHM(r);const u=o.oxw();return o.KtG(u.onKeyDownPhoneNumber(s))}),o.qZA()()(),o.TgZ(38,"div",21)(39,"button",22),o.NdJ("click",function(){o.CHM(r);const s=o.oxw();return o.KtG(s.openDialog())}),o._uU(40," Update password "),o.qZA()(),o._UZ(41,"div",23),o.qZA()}if(2&t){const r=o.MAs(30),e=o.oxw();o.Q6J("formGroup",e.profileForm),o.xp6(6),o.Q6J("ngIf",null==e.profileForm.get("FullName").errors?null:e.profileForm.get("FullName").errors.required),o.xp6(1),o.Q6J("ngIf",null==e.profileForm.get("FullName").errors?null:e.profileForm.get("FullName").errors.pattern),o.xp6(5),o.Q6J("ngIf",null==e.profileForm.get("WorkEmail").errors?null:e.profileForm.get("WorkEmail").errors.notWorkEmail),o.xp6(1),o.Q6J("ngIf",null==e.profileForm.get("WorkEmail").errors?null:e.profileForm.get("WorkEmail").errors.email),o.xp6(1),o.Q6J("ngIf",null==e.profileForm.get("WorkEmail").errors?null:e.profileForm.get("WorkEmail").errors.required),o.xp6(5),o.Q6J("ngIf",null==e.profileForm.get("Company").errors?null:e.profileForm.get("Company").errors.required),o.xp6(5),o.Q6J("ngIf",null==e.profileForm.get("Position").errors?null:e.profileForm.get("Position").errors.required),o.xp6(4),o.Q6J("matAutocomplete",r),o.xp6(3),o.Q6J("ngForOf",e.filteredCountries),o.xp6(1),o.Q6J("ngIf",null==e.profileForm.get("Country").errors?null:e.profileForm.get("Country").errors.required),o.xp6(1),o.Q6J("ngIf",(null==e.profileForm.get("Country").errors?null:e.profileForm.get("Country").errors.notCountry)&&!(null!=e.profileForm.get("Country").errors&&e.profileForm.get("Country").errors.required))}}const R=["gmail","outlook","yahoo","icloud","aol","gmx","mail","protonmail","zoho","tutanota","hushmail","fastmail","yandex","mail","zimbra","prodigy","rackspace"];function S(t){const i=t.value.split("@")[1]?.split(".")[0];return R.includes(i)?{notWorkEmail:!0}:null}let j=(()=>{class t{constructor(r,e,s){this.dialog=r,this._userService=e,this.snackBar=s,this.profileDetailsLoading=!0,this.savingProfileLoading=!1,this.countries=q.o,this.filteredCountries=this.countries}ngOnInit(){this.profileForm=new n.cw({FullName:new n.NI("",[n.kI.required,n.kI.pattern("^.+(?: +.+ *)+$")]),WorkEmail:new n.NI("",[n.kI.required,n.kI.email,S]),Country:new n.NI("",[n.kI.required,r=>this.filteredCountries.includes(r.value.replace(/^\w/,e=>e.toUpperCase()))?null:{notCountry:!0}]),Position:new n.NI("",n.kI.required),Company:new n.NI("",n.kI.required),PhoneNumber:new n.NI("",n.kI.required)}),this.profileForm.get("Country")?.valueChanges.subscribe(r=>{this.filteredCountries=this._filter(r)}),this._userService.get().subscribe({next:r=>{console.log(r),this.profileDetailsLoading=!1,this.profileForm.setValue({FullName:r.fullname,WorkEmail:r.email,Country:r.country,Position:r.position,Company:r.company,PhoneNumber:r.phone_number})}})}_filter(r){const e=r.toLowerCase();return this.countries.filter(s=>s.toLowerCase().includes(e))}openDialog(){this.dialog.open(U)}updateUser(){this.savingProfileLoading=!0;const r={fullname:this.profileForm.getRawValue().FullName.trim(),email:this.profileForm.getRawValue().WorkEmail.trim(),country:this.profileForm.getRawValue().Country.trim(),company:this.profileForm.getRawValue().Company.trim(),position:this.profileForm.getRawValue().Position.trim(),phone_number:this.profileForm.getRawValue().PhoneNumber.trim()};console.log(r),this._userService.update(r).subscribe({next:e=>{console.log(e),this.snackBar.open("user updated successfully","close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]}),this.savingProfileLoading=!1,this.profileForm.markAsPristine()},error:e=>{this.snackBar.open(e.error.msg?e.error.msg:"An error has occurred. Please try again later.","close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-red"]}),this.savingProfileLoading=!1}})}onKeyDownPhoneNumber(r){/[a-zA-Z%^!@#$%^&*_|=\\{}\[\]:";'<>?,./]/.test(r.key)&&1===r.key.length&&r.preventDefault()}}return t.\u0275fac=function(r){return new(r||t)(o.Y36(P.uw),o.Y36(y.K),o.Y36(c.ux))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-profile"]],standalone:!0,features:[o.jDz],decls:11,vars:7,consts:[[1,"container","my-2","px-14","mt-10","max-w-full","md:max-w-4xl"],[1,"header-title","flex","justify-between","items-center","my-6","mx-0"],[1,"profile-details-container","flex","items-center"],[1,"profile-details-title"],["form","myForm","type","submit","mat-raised-button","",3,"disabled"],[4,"ngIf"],["id","myForm",3,"formGroup","submit",4,"ngIf"],["diameter","20"],[1,"w-16","h-16","text-blue-500"],["id","myForm",3,"formGroup","submit"],[1,"grid","md:grid-cols-2","gap-x-5","user-details"],["appearance","outline"],["matInput","","formControlName","FullName","placeholder","Full name","type","text"],["matInput","","formControlName","WorkEmail","placeholder","Work email","type","email"],["matInput","","formControlName","Company","placeholder","Company","type","text"],["matInput","","formControlName","Position","placeholder","Position","type","text"],["matInput","","formControlName","Country",3,"matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline","floatLabel","always"],["matInput","","ng2TelInput","","formControlName","PhoneNumber","placeholder","Phone number",3,"keydown"],[1,"relative","w-full","flex","justify-center","py-6","flex-col-reverse","md:flex-row","items-center"],["type","button","mat-raised-button","",2,"color","#fff","background-color","#335579","position","absolute","left","0",3,"click"],[1,"btn-container"],[3,"value"]],template:function(r,e){1&r&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),o._uU(4,"Profile details"),o.qZA()(),o.TgZ(5,"div",2)(6,"button",4),o.YNc(7,k,2,0,"mat-icon",5),o.YNc(8,x,2,0,"span",5),o.qZA()()(),o.YNc(9,J,2,0,"div",5),o.YNc(10,B,42,12,"form",6),o.qZA()),2&r&&(o.xp6(6),o.Akn(e.profileForm.valid&&e.profileForm.dirty&&!e.savingProfileLoading?"background-color:#335579;color:white;":"background-color:#E0E0E0;color:D1D1D1;"),o.Q6J("disabled",!e.profileForm.dirty||!e.profileForm.valid||e.savingProfileLoading),o.xp6(1),o.Q6J("ngIf",e.savingProfileLoading),o.xp6(1),o.Q6J("ngIf",!e.savingProfileLoading),o.xp6(1),o.Q6J("ngIf",e.profileDetailsLoading),o.xp6(1),o.Q6J("ngIf",!e.profileDetailsLoading))},dependencies:[m.ez,m.sg,m.O5,d.Ps,d.Hw,Z.N6,p.c,l.TO,l.KE,l.hX,p.Nt,f.ot,f.lW,l.lN,w.g,w._,n.u5,n._Y,n.Fj,n.JJ,n.JL,n.UX,n.sg,n.u,C.Bz,P.Is,c.ZX,g.Cq,g.$g,I.LD,A.ey,h.Bb,h.XC,h.ZL],styles:['.profile-details-title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.header-title[_ngcontent-%COMP%]{position:relative}.header-title[_ngcontent-%COMP%]:before{content:"";position:absolute;width:100%;height:1px;background-color:#e5e7eb;bottom:-8px}  .custom-style-green{background-color:#10b981;color:#fff}  .custom-style-red{background-color:#fe5157;color:#fff}  .mat-simple-snackbar-action>button{color:#fff}']}),t})()}}]);