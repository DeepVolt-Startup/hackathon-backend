"use strict";(self.webpackChunkDLIA_client=self.webpackChunkDLIA_client||[]).push([[562],{3562:(S,x,s)=>{s.r(x),s.d(x,{CompaniesComponent:()=>ot});var u=s(6895),g=s(9549),m=s(7155),C=s(4859),b=s(7392),d=s(1572),y=s(455),r=s(6308),h=s(8739),v=s(7009),Z=s(4144),f=s(5938),D=s(8754),p=s(4006),w=s(782),A=s(4385),N=s(8563),t=s(4650),I=s(8167),k=s(2510);function U(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Company is required"),t.qZA())}function M(n,i){1&n&&t._UZ(0,"mat-spinner",14)}const O=function(n,i){return{"background-color":n,color:i}};let Y=(()=>{class n{constructor(e,o,a,l,c,T,_,at){this._fb=e,this.dialog=o,this.ref=a,this.adminService=l,this.router=c,this.snackBar=T,this._duialogRef=_,this.data=at,this.isLoading=!1}ngOnInit(){this.CompanyForm=new p.cw({company:new p.NI("",[p.kI.required,p.kI.pattern("^[a-zA-Z]+.[a-zA-Z]+$")])})}createCompany(){console.log(this.CompanyForm.getRawValue());const e={domain:this.CompanyForm.getRawValue().company.trim()};this.isLoading=!0,this.adminService.createCompany(e).subscribe({next:o=>{console.log(o),console.debug(`register successfully ${o}`),this.snackBar.open("Company added successfully","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]}),this.isLoading=!1,this._duialogRef.close(),this.adminService.filter("Register click"),this.ref.close(o)},error:({error:o})=>{console.log(o),this.snackBar.open(o.data.msg?o.data.msg:"Server is down","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style"]}),this.isLoading=!1}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.qu),t.Y36(f.uw),t.Y36(f.so),t.Y36(I.l),t.Y36(k.F0),t.Y36(v.ux),t.Y36(f.so),t.Y36(f.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-company"]],standalone:!0,features:[t.jDz],decls:21,vars:10,consts:[[1,"flex","justify-between"],["mat-dialog-title",""],["mat-icon-button","",1,"close-button",3,"mat-dialog-close"],[1,"close-icon"],[3,"formGroup"],[1,"grid"],["appearance","outline",1,"w-full","mt-4"],["matInput","","formControlName","company","placeholder","domain","type","text"],[4,"ngIf"],[1,"relative","w-full","flex","justify-end"],["mat-button","","mat-dialog-close",""],["type","submit","mat-raised-button","",3,"disabled","click"],[1,"flex","items-center"],["diameter","15","class","px-3 mt-1",4,"ngIf"],["diameter","15",1,"px-3","mt-1"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2," Create Company "),t.qZA(),t.TgZ(3,"button",2)(4,"mat-icon",3),t._uU(5,"close"),t.qZA()()(),t.TgZ(6,"form",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),t._uU(10,"Domain"),t.qZA(),t._UZ(11,"input",7),t.YNc(12,U,2,0,"mat-error",8),t.qZA()(),t.TgZ(13,"div",9)(14,"div")(15,"button",10),t._uU(16,"Cancel"),t.qZA(),t.TgZ(17,"button",11),t.NdJ("click",function(){return o.createCompany()}),t.TgZ(18,"div",12),t.YNc(19,M,1,0,"mat-spinner",13),t._uU(20," Save "),t.qZA()()()()()),2&e&&(t.xp6(3),t.Q6J("mat-dialog-close",!0),t.xp6(3),t.Q6J("formGroup",o.CompanyForm),t.xp6(6),t.Q6J("ngIf",null==o.CompanyForm.get("company").errors?null:o.CompanyForm.get("company").errors.required),t.xp6(5),t.Akn(t.WLB(7,O,o.CompanyForm.valid&&!o.isLoading?"#335579":"#E0E0E0",o.CompanyForm.valid&&!o.isLoading?"white":"D1D1D1")),t.Q6J("disabled",!o.CompanyForm.valid||o.isLoading),t.xp6(2),t.Q6J("ngIf",o.isLoading))},dependencies:[b.Ps,b.Hw,w.N6,Z.c,g.TO,g.KE,g.hX,Z.Nt,C.ot,C.lW,g.lN,N.g,p.u5,p._Y,p.Fj,p.JJ,p.JL,f.Is,f.ZT,f.uh,p.UX,p.sg,p.u,u.ez,u.O5,A.LD,d.Cq,d.$g],styles:[".custom-style{background-color:#fe5157;color:#fff}  .custom-style-green{background-color:#10b981;color:#fff}  .mat-simple-snackbar-action>button{color:#fff}"]}),n})();var B=s(6709),J=s(3238);function E(n,i){1&n&&(t.TgZ(0,"th",32),t._uU(1," Domain "),t.qZA())}function P(n,i){if(1&n&&(t.TgZ(0,"td",33),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",e.domain," ")}}function R(n,i){1&n&&(t.TgZ(0,"th",34),t._uU(1," Number of users "),t.qZA())}function j(n,i){if(1&n&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",e.count," ")}}function F(n,i){1&n&&(t.TgZ(0,"th",32),t._uU(1," Access "),t.qZA())}function Q(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",35)(1,"mat-slide-toggle",36),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.setAccessCompanyDialog(l))}),t.qZA()()}if(2&n){const e=i.$implicit;t.xp6(1),t.Q6J("checked",e.has_access)}}function $(n,i){1&n&&(t.TgZ(0,"th",37),t._uU(1," Company status "),t.qZA())}function H(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",35)(1,"mat-form-field",38)(2,"mat-label"),t._uU(3),t.qZA(),t.TgZ(4,"mat-select",39),t.NdJ("ngModelChange",function(a){const c=t.CHM(e).$implicit;return t.KtG(c.company_status=a)})("ngModelChange",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onStatusChange(l))}),t.TgZ(5,"mat-option",40),t._uU(6,"Deleted"),t.qZA(),t.TgZ(7,"mat-option",41),t._uU(8,"Blocked"),t.qZA(),t.TgZ(9,"mat-option",42),t._uU(10,"Active"),t.qZA(),t.TgZ(11,"mat-option",43),t._uU(12,"Active unlimitedly"),t.qZA(),t.TgZ(13,"mat-option",44),t._uU(14,"On trial"),t.qZA()()()()}if(2&n){const e=i.$implicit;t.xp6(3),t.Oqu(e.company_status),t.xp6(1),t.Q6J("ngModel",e.company_status)}}function q(n,i){1&n&&(t.TgZ(0,"th",32),t._uU(1," Company predict credit "),t.qZA())}function z(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",35)(1,"mat-form-field",38)(2,"mat-label"),t._uU(3,"Company predict credit"),t.qZA(),t.TgZ(4,"input",45),t.NdJ("ngModelChange",function(a){const c=t.CHM(e).$implicit;return t.KtG(c.company_predict_credit=a)})("input",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onPredictCreditChange(l))}),t.qZA()()()}if(2&n){const e=i.$implicit;t.xp6(4),t.Q6J("ngModel",e.company_predict_credit)}}function L(n,i){1&n&&(t.TgZ(0,"th",46),t._uU(1," Action "),t.qZA())}function G(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw(2);return t.KtG(l.openDeleteDialog(a.company_id,a.domain))}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function K(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",47)(1,"button",48)(2,"mat-icon"),t._uU(3,"cancel"),t.qZA()(),t.TgZ(4,"button",49),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.updateCompanyDetails(l))}),t.TgZ(5,"mat-icon"),t._uU(6,"save"),t.qZA()(),t.YNc(7,G,3,0,"button",50),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw(2);t.xp6(4),t.Q6J("disabled",!e.touched||!o.statusChanged&&!o.predictCreditChanged),t.xp6(3),t.Q6J("ngIf",0==e.count)}}function W(n,i){1&n&&t._UZ(0,"tr",52)}function V(n,i){1&n&&t._UZ(0,"tr",53)}function X(n,i){1&n&&(t.TgZ(0,"tr",54)(1,"td",55),t._uU(2," --\x3e "),t.qZA()())}function tt(n,i){1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2,"No data available"),t.qZA(),t.BQk())}function et(n,i){if(1&n&&(t.TgZ(0,"table",13,14),t.ynx(2,15),t.YNc(3,E,2,0,"th",16),t.YNc(4,P,2,1,"td",17),t.BQk(),t.ynx(5,18),t.YNc(6,R,2,0,"th",19),t.YNc(7,j,2,1,"td",20),t.BQk(),t.ynx(8,21),t.YNc(9,F,2,0,"th",16),t.YNc(10,Q,2,1,"td",20),t.BQk(),t.ynx(11,22),t.YNc(12,$,2,0,"th",23),t.YNc(13,H,15,2,"td",20),t.BQk(),t.ynx(14,24),t.YNc(15,q,2,0,"th",16),t.YNc(16,z,5,1,"td",20),t.BQk(),t.ynx(17,25),t.YNc(18,L,2,0,"th",26),t.YNc(19,K,8,2,"td",27),t.BQk(),t.YNc(20,W,1,0,"tr",28),t.YNc(21,V,1,0,"tr",29),t.YNc(22,X,3,0,"tr",30),t.YNc(23,tt,3,0,"ng-container",31),t.qZA()),2&n){const e=t.oxw();t.Q6J("dataSource",e.dataSource),t.xp6(20),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(2),t.Q6J("ngIf",e.noDataAvailable)}}const nt=function(){return[5,10,25,100]};let ot=(()=>{class n{constructor(e,o,a,l){this.adminService=e,this.dialog=o,this.cdr=a,this.snackBar=l,this.displayedColumns=["domain","users_number","access","status","companyPredictCredit","action"],this.dataSource=new m.by([]),this.pageIndex=0,this.noDataAvailable=!1,this.selectedStatus="",this.showTable=!1,this.statusChanged=!1,this.predictCreditChanged=!1,this.companiesResponse={data:[],status:null},this.adminService.listen().subscribe(c=>{console.log(c)})}ngOnInit(){this.getCompanies()}ngAfterViewInit(){this.dataSource=new m.by,this.dataSource.sort=this.sort}getCompanies(){this.adminService.getCompanies().subscribe({next:e=>{e.data.sort((o,a)=>new Date(a.updated_at).getTime()-new Date(o.updated_at).getTime()),this.companies=e,this.dataSource=new m.by(e.data),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.companiesResponse={data:e.data,status:null},this.noDataAvailable=0===this.companiesResponse.data.length},error:console.log})}setAccessCompanyDialog(e){const o=e.has_access;console.log("ttttttttttttttttt",e);const a=this.dialog.open(D.$,{data:{title:e.has_access?"Block company":"Unblock company",content:`Do you want to ${e.has_access?"block":"unblock"} this company: ${e.domain}?`},height:"200px",minWidth:"150px",width:"400px",minHeight:"180px"});console.log("aaaaaaaaaa",e),a.afterClosed().subscribe(l=>{if(l){const T=e.has_access?"blocked":"unblocked";this.adminService.setAccessCompany(e.company_id,!e.has_access).subscribe({next:()=>{this.adminService.filter("Register click"),this.snackBar.open(`company ${T} successfully`,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]}),console.log(`Access for company ${e.domain} has been ${T}.`)},error:_=>{this.snackBar.open(_.error.msg?_.error.msg:"Server is down","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style"]}),console.error(_),e.has_access=!e.has_access}})}else e.has_access=o,console.log(e.has_access),this.adminService.filter("Register click")})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.pageIndex=0,this.dataSource.paginator&&this.dataSource.paginator.firstPage()}openDeleteDialog(e,o){const a=this.dialog.open(D.$,{data:{title:"Delete Comapny",content:`Do you want to delete this Company ${o}`},height:"200px",minWidth:"150px",width:"400px",minHeight:"180px"});a.afterClosed().subscribe(l=>{l?this.adminService.deleteCompany(e).subscribe({next:c=>{this.snackBar.open("Company deleted successfully","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style-green"]}),this.dialog.closeAll();let T=this.dataSource.data.findIndex(_=>_.domain===o);this.dataSource.data.splice(T,1),this.dataSource=new m.by(this.dataSource.data),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},error:c=>{console.error(c),this.snackBar.open(c.error.msg?c.error.msg:"Server is down","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["custom-style"]})}}):a.close()})}openCreateCompanyDialog(){this.dialog.open(Y,{data:{},height:"230px",minWidth:"150px",width:"500px",minHeight:"180px"}).afterClosed().subscribe({next:o=>{o&&(console.log("res.data:",o.data),o.data.companies.sort((a,l)=>new Date(l.updated_at).getTime()-new Date(a.updated_at).getTime()),this.dataSource=new m.by(this.dataSource.data=o.data.companies),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log("this.datasource:",this.dataSource),this.cdr.detectChanges())}})}updateButtonStatus(e){this.statusChanged=e.touched&&e.company_status!==e.initial_status,this.predictCreditChanged=e.touched&&e.company_predict_credit!==e.initial_predict_credit}onStatusChange(e){e.touched=!0,this.updateButtonStatus(e)}onPredictCreditChange(e){e.touched=!0,this.updateButtonStatus(e)}updateCompanyDetails(e){console.log("tttttttttttt",e),this.adminService.updateCompanyDetails(e.company_id,{company_status:e.company_status,company_predict_credit:e.company_predict_credit}).subscribe({next:a=>{console.log("Company details updated successfully:",a),this.getCompanies()},error:a=>{console.error("Failed to update company details:",a)}})}isFormValid(e){return null!==e.company_status&&null!==e.company_predict_credit}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(I.l),t.Y36(f.uw),t.Y36(t.sBO),t.Y36(v.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-companies"]],viewQuery:function(e,o){if(1&e&&(t.Gf(h.NW,5),t.Gf(r.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first),t.iGM(a=t.CRH())&&(o.sort=a.first)}},standalone:!0,features:[t.jDz],decls:18,vars:6,consts:[[1,"w-full","flex","flex-col","justify-center","items-center","mt-20",2,"background-color","white"],[1,"w-11/12","flex","justify-between","items-center","h-3"],[1,"text-2xl","font-medium","mb-6",2,"color","#335579"],[1,"flex","items-center","justify-center"],["appearance","outline",1,"w-44","justify-self-end",2,"font-size","10px"],["matInput","",3,"keyup"],["input",""],["matSuffix",""],["mat-raised-button","",2,"background-color","#335579","color","white","margin-left","20px","margin-bottom","15px",3,"click"],[1,"table-container","w-11/12","justify-between","sticky","mt-4"],["mat-table","","class","","style","width: 100%","matSort","",3,"dataSource",4,"ngIf"],[1,"flex","justify-end","w-full","fixed","bottom-0","right-0","z-10"],[3,"length","pageSize","pageIndex","pageSizeOptions"],["mat-table","","matSort","",1,"",2,"width","100%",3,"dataSource"],["showTable",""],["matColumnDef","domain"],["mat-header-cell","","mat-sort-header","","class","text-lg font-medium mb-6",4,"matHeaderCellDef"],["mat-cell","","class","text-base font-normal mb-6 test",4,"matCellDef"],["matColumnDef","users_number"],["mat-header-cell","","mat-sort-header","","class","text-lg font-medium mb-6","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","text-base font-normal mb-6",4,"matCellDef"],["matColumnDef","access"],["matColumnDef","status"],["mat-header-cell","","class","text-lg font-medium mb-6",4,"matHeaderCellDef"],["matColumnDef","companyPredictCredit"],["matColumnDef","action"],["mat-header-cell","","class","text-lg font-medium mb-6","style","text-align: center",4,"matHeaderCellDef"],["mat-cell","","class","flex justify-center items-center mt-4",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[4,"ngIf"],["mat-header-cell","","mat-sort-header","",1,"text-lg","font-medium","mb-6"],["mat-cell","",1,"text-base","font-normal","mb-6","test"],["mat-header-cell","","mat-sort-header","","mat-sort-header","",1,"text-lg","font-medium","mb-6"],["mat-cell","",1,"text-base","font-normal","mb-6"],[3,"checked","click"],["mat-header-cell","",1,"text-lg","font-medium","mb-6"],["appearance","outline",1,"mt-2"],[3,"ngModel","ngModelChange"],["value","Deleted"],["value","Blocked"],["value","Active"],["value","ActiveUnlimitedly"],["value","OnTrial"],["matInput","","placeholder","Predict","type","number","step","1.00",3,"ngModel","ngModelChange","input"],["mat-header-cell","",1,"text-lg","font-medium","mb-6",2,"text-align","center"],["mat-cell","",1,"flex","justify-center","items-center","mt-4"],["mat-icon-button","","matTooltip","Cancel"],["mat-icon-button","","matTooltip","Action",3,"disabled","click"],["mat-icon-button","","style","color: red","matTooltip","Basic",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Basic",2,"color","red",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3," Companies "),t.qZA(),t.TgZ(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),t._uU(7,"Search"),t.qZA(),t.TgZ(8,"input",5,6),t.NdJ("keyup",function(l){return o.applyFilter(l)}),t.qZA(),t.TgZ(10,"mat-icon",7),t._uU(11,"search"),t.qZA()(),t.TgZ(12,"button",8),t.NdJ("click",function(){return o.openCreateCompanyDialog()}),t._uU(13," Add company "),t.qZA()()(),t.TgZ(14,"div",9),t.YNc(15,et,24,4,"table",10),t.TgZ(16,"div",11),t._UZ(17,"mat-paginator",12),t.qZA()()()),2&e&&(t.xp6(15),t.Q6J("ngIf",!o.noDataAvailable),t.xp6(2),t.Q6J("length",o.dataSource.data.length)("pageSize",10)("pageIndex",o.pageIndex)("pageSizeOptions",t.DdM(5,nt)))},dependencies:[B.p9,m.p0,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,m.Ee,g.lN,g.KE,g.hX,g.R9,C.ot,C.lW,b.Ps,b.Hw,d.Cq,y.rP,y.Rr,f.Is,Z.c,Z.Nt,v.ZX,h.TU,h.NW,r.JX,r.YE,r.nU,u.ez,u.O5,A.LD,A.gD,J.ey,p.u5,p.Fj,p.wV,p.JJ,p.On],styles:[".mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-bar{background-color:#335579;z-index:0}  .mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-thumb{background-color:#335579;z-index:-1}  thead th.mat-header-cell, td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%]{border-bottom:none}tr[_ngcontent-%COMP%]{border-bottom:1px solid #f1f1f1}"]}),n})()},8563:(S,x,s)=>{s.d(x,{_:()=>C,g:()=>b});var u=s(4650),g=s(6895);let C=(()=>{class d{constructor(r,h){this.el=r,this.platformId=h,this.ng2TelInputOptions={},this.hasError=new u.vpe,this.ng2TelOutput=new u.vpe,this.countryChange=new u.vpe,this.intlTelInputObject=new u.vpe}ngOnInit(){(0,g.NF)(this.platformId)&&(this.ng2TelInputOptions=Object.assign({},this.ng2TelInputOptions,{utilsScript:this.getUtilsScript(this.ng2TelInputOptions)}),this.ngTelInput=window.intlTelInput(this.el.nativeElement,Object.assign({},this.ng2TelInputOptions)),this.el.nativeElement.addEventListener("countrychange",()=>{this.countryChange.emit(this.ngTelInput.getSelectedCountryData())}),this.intlTelInputObject.emit(this.ngTelInput))}onBlur(){let r=this.isInputValid();if(r){let h=this.ngTelInput.getNumber();this.hasError.emit(r),this.ng2TelOutput.emit(h)}else this.hasError.emit(r)}isInputValid(){return this.ngTelInput.isValidNumber()}setCountry(r){this.ngTelInput.setCountry(r)}getUtilsScript(r){return r.utilsScript||"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/16.0.1/js/utils.js"}}return d.\u0275fac=function(r){return new(r||d)(u.Y36(u.SBq),u.Y36(u.Lbi))},d.\u0275dir=u.lG2({type:d,selectors:[["","ng2TelInput",""]],hostBindings:function(r,h){1&r&&u.NdJ("blur",function(){return h.onBlur()})},inputs:{ng2TelInputOptions:"ng2TelInputOptions"},outputs:{hasError:"hasError",ng2TelOutput:"ng2TelOutput",countryChange:"countryChange",intlTelInputObject:"intlTelInputObject"}}),d})(),b=(()=>{class d{static forRoot(){return{ngModule:d,providers:[]}}}return d.\u0275fac=function(r){return new(r||d)},d.\u0275mod=u.oAB({type:d}),d.\u0275inj=u.cJS({}),d})()}}]);